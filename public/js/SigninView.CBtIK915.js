import{d as R,f as r,I as T,S as B,g as I,o as b,m as S,w as i,b as s,T as L,c as A,u as p,e as m,t as E,p as V,a as l,i as M,q as N,B as P,r as U,_ as q}from"../index.js";import{_ as F,P as G}from"./PlainLayout.ContBw-A.js";import{I as D}from"./InputGroup.B4554_nz.js";import{_ as K}from"./PasswordInput.vue_vue_type_script_setup_true_lang.DTq_JsKd.js";import{I as $,A as j,g as O}from"./AlertSuccess.XtL0Ql-0.js";import{u as z}from"./authComposable.-2CSDGmy.js";import{_ as W}from"./SpinnerLoading.vue_vue_type_script_setup_true_lang.CuUXFzUo.js";import"./logo-ppdb.BW9ypDwz.js";import"./login-ilustrasi.CSbcqYU5.js";const H={key:0,class:"mb-2 mt-4"},J={class:"mb-5 mt-6"},Q=["disabled"],X={class:"flex items-center"},Y={class:"mt-6 text-center"},Z={class:"font-medium"},ee=R({__name:"SigninView",setup(ae){const c=r(""),f=r(""),d=r(!1),t=r(!1),n=r(""),{login:h}=z(),g=N(),x=T(),v=B(),C=async()=>{try{await O()}catch{P({message:"Gagal mengambil CSRF token, silakan muat ulang halaman login ini",type:"warning",duration:5e3,autoClose:!0})}},y=async()=>{var o,e,u;d.value=!0,t.value=!1;try{await h(c.value,f.value)}catch(a){((o=a==null?void 0:a.response)==null?void 0:o.status)===401||((e=a==null?void 0:a.response)==null?void 0:e.status)===422?(t.value=!0,n.value="Username atau password salah"):((u=a==null?void 0:a.response)==null?void 0:u.status)===429?(t.value=!0,n.value="Terlalu banyak percobaan login, coba lagi beberapa saat"):(a==null?void 0:a.code)==="ERR_NETWORK"?(t.value=!0,n.value="Koneksi internet bermasalah"):(t.value=!0,n.value="Sepertinya jaringan anda atau server kami mengalami masalah, coba lagi beberapa saat")}finally{d.value=!1}};return I(async()=>{const o=g.query.intended||"/dashboard";x.intendedURL=o,g.query.prompt&&(t.value=!0,n.value=g.query.prompt),await C()}),(o,e)=>{const u=U("router-link");return b(),S(G,null,{default:i(()=>[s(F,{subtitle:"PPDB Online Kuantan Singingi v1",title:"Login"},{default:i(()=>{var a,k,w;return[s(L,{name:"fade-slide-up"},{default:i(()=>[t.value?(b(),A("div",H,[s(p($),{icon:"",type:"danger"},{default:i(()=>[m(E(n.value),1)]),_:1})])):V("",!0)]),_:1}),(a=p(v).messages)!=null&&a.success?(b(),S(j,{key:0,class:"mb-5",message:(k=p(v).messages)==null?void 0:k.success.title,detail:(w=p(v).messages)==null?void 0:w.success.detail},null,8,["message","detail"])):V("",!0),l("form",{onSubmit:M(y,["prevent"])},[s(D,{name:"username",label:"Email / Username",type:"email",placeholder:"Enter your email",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=_=>c.value=_)},null,8,["modelValue"]),s(K,{label:"Password anda",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=_=>f.value=_)},null,8,["modelValue"]),l("div",J,[l("button",{type:"submit",class:"w-full flex justify-center items-center cursor-pointer rounded-lg border border-primary bg-primary p-2 font-medium text-white transition hover:bg-opacity-90",onClick:y,disabled:d.value},[l("span",X,[s(W,{loading:d.value,size:"xs"},null,8,["loading"]),e[2]||(e[2]=l("span",{class:"ml-2"},"Login",-1))])],8,Q)]),l("div",Y,[l("p",Z,[e[5]||(e[5]=m(" Belum Mempunyai Akun? ")),s(u,{to:"/daftar",class:"text-primary"},{default:i(()=>e[3]||(e[3]=[m("Daftar")])),_:1}),e[6]||(e[6]=m(" atau ")),s(u,{to:"sekolah/daftar",class:"text-primary"},{default:i(()=>e[4]||(e[4]=[m("daftarkan sekolah anda")])),_:1})])])],32)]}),_:1})]),_:1})}}}),de=q(ee,[["__scopeId","data-v-68fc65db"]]);export{de as default};
