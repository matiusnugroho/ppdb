import{_ as te,a as se}from"./DefaultLayout.vue_vue_type_script_setup_true_lang.6-Gez_Sj.js";import{u as R}from"./formValidationErrors.YeWR-HPr.js";import{u as ae}from"./useCekPendaftaran.D3hBySMT.js";import{h as _,M as K,L as z,d as j,_ as Q,a as t,c as i,b as e,t as b,g as B,I as Y,A as q,Q as W,o as F,u as p,p as L,e as $,n as N,f as U,j as E,U as oe,l as le,C as P,F as A,k as I,B as V,x as ne,J as O,w as re,K as ie}from"../index.js";import{a as de}from"./useSekolah.DNM2-tfN.js";import{S as ce,b as G}from"./buatOption.Bie55yYu.js";import{_ as ue}from"./SelectGroup.vue_vue_type_script_setup_true_lang.DQawecAY.js";import{b as me,A as fe,g as ge}from"./AlertSuccess.DVwU4fFw.js";import{f as Z}from"./fieldErrorHtml.BloJiExM.js";import{u as X}from"./usePendaftaran.DplSNUYV.js";import{_ as pe}from"./ConfirmationComponent.vue_vue_type_script_setup_true_lang.BkkGE_n-.js";import{g as he}from"./getDataById.CToqdZWp.js";import{_ as ve}from"./NoDataComponent.vue_vue_type_script_setup_true_lang.0N8bNYdP.js";import"./authComposable.sKl44bRY.js";import"./logo-ppdb.BW9ypDwz.js";import"./SpinnerLoading.vue_vue_type_script_setup_true_lang.CQvHfLuO.js";import"./index.BB3keK1r.js";function xe(){const s=_(!1),f=R(),x=_(null);return{registerSekolah:async h=>{var l,u,d,m;s.value=!0;try{return await K.post(z.DAFTAR_KE_SEKOLAH,h)}catch(k){f.errors=((u=(l=k.response)==null?void 0:l.data)==null?void 0:u.errors)||{};const w=(m=(d=k.response)==null?void 0:d.data)==null?void 0:m.message;return x.value=w,k.response}finally{s.value=!1}},loadingRegister:s,errorDaftar:x}}const ke=j({name:"AlertError",props:{message:{type:String,required:!0},detail:{type:String,required:!1}}}),be={class:"flex w-full border-l-6 border-[#F87171] bg-[#F87171] bg-opacity-[15%] px-2 py-2 shadow-md dark:bg-[#1B1B24] dark:bg-opacity-30 md:p-9"},_e={class:"w-full"},ye={class:"mb-3 text-lg font-bold text-black dark:text-[#34D399]"},we={key:0,class:"text-base leading-relaxed text-body"};function $e(s,f,x,D,h,l){return t(),i("div",be,[f[0]||(f[0]=e("div",{class:"mr-5 flex h-9 w-full max-w-[36px] items-center justify-center rounded-lg bg-[#F87171]"},[e("svg",{width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M6.4917 7.65579L11.106 12.2645C11.2545 12.4128 11.4715 12.5 11.6738 12.5C11.8762 12.5 12.0931 12.4128 12.2416 12.2645C12.5621 11.9445 12.5623 11.4317 12.2423 11.1114C12.2422 11.1113 12.2422 11.1113 12.2422 11.1113C12.242 11.1111 12.2418 11.1109 12.2416 11.1107L7.64539 6.50351L12.2589 1.91221L12.2595 1.91158C12.5802 1.59132 12.5802 1.07805 12.2595 0.757793C11.9393 0.437994 11.4268 0.437869 11.1064 0.757418C11.1063 0.757543 11.1062 0.757668 11.106 0.757793L6.49234 5.34931L1.89459 0.740581L1.89396 0.739942C1.57364 0.420019 1.0608 0.420019 0.740487 0.739944C0.42005 1.05999 0.419837 1.57279 0.73985 1.89309L6.4917 7.65579ZM6.4917 7.65579L1.89459 12.2639L1.89395 12.2645C1.74546 12.4128 1.52854 12.5 1.32616 12.5C1.12377 12.5 0.906853 12.4128 0.758361 12.2645L1.1117 11.9108L0.758358 12.2645C0.437984 11.9445 0.437708 11.4319 0.757539 11.1116C0.757812 11.1113 0.758086 11.111 0.75836 11.1107L5.33864 6.50287L0.740487 1.89373L6.4917 7.65579Z",fill:"#ffffff",stroke:"#ffffff"})])],-1)),e("div",_e,[e("h5",ye,b(s.message),1),s.detail?(t(),i("p",we,b(s.detail),1)):B("",!0)])])}const De=Q(ke,[["render",$e]]),Se={class:"max-w-md mx-auto mt-10 p-5 bg-white rounded-lg shadow-md"},Pe={class:"mb-4"},Ce=["innerHTML"],Be={class:"mb-4"},Le=["innerHTML"],Te=["disabled"],Me={class:"flex items-center gap-2"},je=j({__name:"BelumDaftar",emits:["refreshParent"],setup(s,{emit:f}){const{fetchSekolah:x,sekolahList:D,loadingSekolah:h}=de(),{loadingRegister:l,registerSekolah:u,errorDaftar:d}=xe(),m=R(),k=f,{dataJalurPendaftaran:w,fetchJalurPendaftaran:y}=X(),v=Y(),n=_(""),o=_(""),a=q(()=>G(D.value,"nama_sekolah","id")),T=q(()=>G(w.value,"name","id")),M=W(),C=async()=>{if(m.clearErrors(),!o.value||!n.value){n.value||m.addError("sekolah_id","Pilih Sekolah terlebih dahulu"),o.value||m.addError("registration_path_id","Pilih Jalur Pendaftaran");return}const r={school_id:n.value,jenjang:v.biodata.jenjang,registration_path_id:o.value},g=await u(r);g.data.success&&(M.addMessage("success",{title:"Pendaftaran Berhasil",detail:"Silakan Lengkapi dokumen"}),k("refreshParent",g.data.data))};return F(()=>{x(v.biodata.kecamatan_id,v.biodata.jenjang),y()}),(r,g)=>(t(),i("div",Se,[g[3]||(g[3]=e("h1",{class:"text-xl font-bold mb-5 text-center"},"Pendaftaran",-1)),p(d)?(t(),L(De,{key:0,message:"Gagal Mendaftar",detail:p(d),class:"mb-5"},null,8,["detail"])):B("",!0),e("form",{onSubmit:E(C,["prevent"])},[e("div",Pe,[$(ue,{label:"Pilih Jalur Pendaftaran",placeholder:"Pilih Jalur",options:T.value,modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=S=>o.value=S)},null,8,["options","modelValue"]),e("div",{innerHTML:p(Z)("registration_path_id")},null,8,Ce)]),e("div",Be,[$(ce,{label:"Pilih Sekolah",placeholder:"Pilih Sekolah",options:a.value,modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=S=>n.value=S),loading:p(h)},null,8,["options","modelValue","loading"]),e("div",{innerHTML:p(Z)("sekolah_id")},null,8,Le)]),e("button",{class:"flex justify-center rounded bg-primary py-2 px-6 font-medium text-white hover:bg-opacity-90",type:"submit",disabled:p(l)},[e("span",Me,[p(l)?(t(),L(p(me),{key:0,size:"4",color:"white",class:N(["transition-all duration-500 ease-out",{"opacity-0 -translate-x-5":!p(l),"opacity-100 translate-x-0":p(l)}])},null,8,["class"])):B("",!0),g[2]||(g[2]=U("Daftar "))])],8,Te)],32)]))}});function Ee(){const s=_([]),f=_(null),x=_(!1);return{documentTypeList:s,error:f,loadingDocumentType:x,fetchDocumentType:async()=>{x.value=!0;try{const h=await K.get(z.GET_DOCUMENT_TYPE);s.value=h.data}catch{f.value="Failed to load Document Type list"}finally{x.value=!1}}}}function Ue(){const s=_(!1),f=R();return{uploadDokumen:async(D,h,l)=>{var d,m;s.value=!0;let u;try{switch(h){case"upload":u="UPLOAD_DOKUMEN";break;case"revisi":u="REVISI_DOKUMEN";break;default:u="REVISI_DOKUMEN"}const k=oe(z[u],{id_dokumen:D.id_dokumen}),w=new FormData;w.append("file",D.file),w.append("id_dokumen",D.id_dokumen),l&&w.append("alasan",l);const y=await K.post(k,w);return y.data.success?y.data:(f.errors=y.data.errors,!1)}catch(k){return f.errors=((m=(d=k.response)==null?void 0:d.data)==null?void 0:m.errors)||{file:[k.response.message]},k.response.data}finally{s.value=!1}},loadingUploadDokumen:s}}const Ve={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity"},Ne={class:"w-full max-w-lg bg-white rounded-xl shadow-lg transform transition-all p-6"},Ae={class:"flex justify-between items-start mb-4"},Fe={class:"text-xl font-bold text-gray-900"},Re={class:"text-sm text-gray-500 mt-1"},Oe={class:"flex flex-col items-center justify-center pointer-events-none"},Ie={class:"bg-blue-100 p-3 rounded-full mb-3 text-blue-600"},Ke={key:0,class:"text-center"},ze={class:"text-gray-900 font-medium break-all"},He={class:"text-xs text-gray-500 mt-1"},Je={key:1,class:"text-center"},qe={class:"flex justify-end items-center gap-3 mt-6"},Ge=["disabled"],Ze={key:0,class:"loading loading-spinner loading-xs"},Qe=j({__name:"UploadModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Upload Dokumen"},subtitle:{type:String,default:"Lampirkan file pendukung"},loading:{type:Boolean,default:!1}},emits:["close","upload"],setup(s,{emit:f}){const x=s,D=f,h=_(!1),l=_(null),u=_(null),d=()=>{l.value=null,u.value&&(u.value.value=""),D("close")},m=n=>{const o=n.target;o.files&&o.files[0]&&(l.value=o.files[0])},k=n=>{var o;h.value=!1,(o=n.dataTransfer)!=null&&o.files&&n.dataTransfer.files[0]&&(l.value=n.dataTransfer.files[0])},w=()=>{l.value=null,u.value&&(u.value.value="")},y=()=>{l.value&&D("upload",l.value)},v=n=>{if(n===0)return"0 Bytes";const o=1024,a=["Bytes","KB","MB","GB"],T=Math.floor(Math.log(n)/Math.log(o));return parseFloat((n/Math.pow(o,T)).toFixed(2))+" "+a[T]};return le(()=>x.show,n=>{n||(l.value=null,u.value&&(u.value.value=""))}),(n,o)=>s.show?(t(),i("div",Ve,[e("div",Ne,[e("div",Ae,[e("div",null,[e("h3",Fe,b(s.title),1),e("p",Re,b(s.subtitle),1)]),e("button",{onClick:d,class:"text-gray-400 hover:text-gray-600 transition-colors"},[$(P,{name:"x-mark",class:"w-6 h-6"})])]),e("div",{class:N(["relative border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:bg-gray-50 transition-colors",{"border-primary bg-blue-50":h.value}]),onDragenter:o[0]||(o[0]=E(a=>h.value=!0,["prevent"])),onDragleave:o[1]||(o[1]=E(a=>h.value=!1,["prevent"])),onDragover:o[2]||(o[2]=E(()=>{},["prevent"])),onDrop:E(k,["prevent"])},[e("input",{type:"file",ref_key:"fileInputRef",ref:u,class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:m,accept:".pdf,.jpg,.jpeg,.png"},null,544),e("div",Oe,[e("div",Ie,[$(P,{name:"cloud-arrow-up",class:"w-8 h-8"})]),l.value?(t(),i("div",Ke,[e("p",ze,b(l.value.name),1),e("p",He,b(v(l.value.size)),1),e("button",{onClick:E(w,["stop"]),class:"text-red-500 text-sm mt-2 hover:underline pointer-events-auto"},"Ganti File")])):(t(),i("div",Je,o[3]||(o[3]=[e("p",{class:"text-gray-900 font-medium"},[e("span",{class:"text-gray-900"},"Klik untuk upload"),e("span",{class:"text-gray-500"}," atau drag file")],-1),e("p",{class:"text-xs text-gray-400 mt-2"},"PDF, JPG, atau PNG (Maks. 2MB)",-1)])))])],34),e("div",qe,[e("button",{onClick:d,class:"px-4 py-2 text-gray-700 font-medium hover:bg-gray-100 rounded-lg transition-colors"}," Batal "),e("button",{onClick:y,disabled:!l.value||s.loading,class:"px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[s.loading?(t(),i("span",Ze)):B("",!0),o[4]||(o[4]=U(" Upload Sekarang "))],8,Ge)])])])):B("",!0)}}),Ye={key:0,class:"text-center mb-5"},We={class:"space-y-8"},Xe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},et={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8 dark:bg-boxdark dark:border-strokedark"},tt={class:"flex flex-col md:flex-row md:items-center gap-8"},st={class:"flex-1 flex items-start gap-5"},at={class:"bg-indigo-50 p-3.5 rounded-2xl text-indigo-600 shrink-0"},ot={class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},lt={class:"md:w-1/3"},nt={class:"flex items-center gap-3 bg-gray-50 p-3 rounded-xl border border-gray-200 dark:bg-meta-4 dark:border-strokedark"},rt={class:"text-xl font-mono font-bold text-gray-900 tracking-wide dark:text-white flex-1 text-center"},it={class:"space-y-6"},dt={class:"flex items-center justify-between"},ct={class:"px-4 py-1.5 bg-gray-100 text-gray-600 rounded-full text-xs font-bold"},ut={class:"space-y-3"},mt={class:"p-4 md:px-6 md:py-5 grid grid-cols-1 md:grid-cols-12 gap-4 items-center"},ft={class:"md:col-span-5"},gt={class:"font-semibold text-gray-900 dark:text-white text-base"},pt={key:0,class:"text-sm text-red-500 mt-1 flex items-center gap-1"},ht={class:"md:col-span-4 flex justify-start md:justify-center"},vt={class:"md:col-span-3 flex items-center justify-end gap-3"},xt=["href"],kt={key:1,class:"p-2 text-gray-300 cursor-not-allowed"},bt=["onClick"],_t={key:3,class:"min-w-[100px] flex justify-center items-center gap-2 text-green-600 font-bold text-sm bg-green-50 px-3 py-2 rounded-lg border border-green-100"},yt=j({__name:"SudahDaftar",props:{registration:{type:Object,required:!0}},setup(s){const f=s,{fetchDocumentType:x,loadingDocumentType:D,documentTypeList:h}=Ee(),l=W(),u=_(!1),d=_(),m=_(null),k=R(),w=_("upload");function y(C,r){return C.find(g=>g.id===r)}const{uploadDokumen:v,loadingUploadDokumen:n}=Ue(),o=(C,r="upload")=>{var S,c;k.clearErrors(),w.value=r,d.value=null,u.value=!0,d.value=C;let g=y(h.value,C);m.value=(c=(S=g.path_requirement)==null?void 0:S.document_type)==null?void 0:c.label},a=()=>{f.registration.registration_number&&(navigator.clipboard.writeText(f.registration.registration_number),V({message:"Nomor pendaftaran telah dicopy",type:"success"}))},T=async C=>{if(!C){V({message:"File tidak boleh kosong",type:"error"});return}const r={id_dokumen:d.value,file:C},g=await v(r,w.value);if(g.success){let S=y(h.value,d.value),c=g.data;S&&(S.status=c.status,S.path=c.path,S.url_path=c.url_path),M(),V({message:"Dokumen berhasil diupload",type:"success"})}else V({message:"Dokumen gagal diupload, "+g.message,type:"error"})},M=()=>{u.value=!1};return F(async()=>{await x()}),(C,r)=>{var g,S;return t(),i(A,null,[p(D)?(t(),i("div",Ye,r[0]||(r[0]=[e("div",null,"Loading",-1)]))):B("",!0),p(l).messages.success?(t(),L(fe,{key:1,class:"mb-5",message:p(l).messages.success.title,detail:p(l).messages.success.detail},null,8,["message","detail"])):B("",!0),e("div",We,[e("div",Xe,[r[1]||(r[1]=e("div",null,[e("h2",{class:"text-3xl font-bold text-gray-900 dark:text-white font-display"},"Detail Pendaftaran"),e("p",{class:"text-base text-gray-500 mt-2"},"Informasi status dan kelengkapan berkas Anda.")],-1)),e("div",null,[e("span",{class:N(["px-5 py-2.5 rounded-full text-xs font-bold border tracking-wider uppercase flex items-center gap-2 shadow-sm",{"bg-orange-50 text-orange-700 border-orange-100":s.registration.status==="pending","bg-green-50 text-green-700 border-green-100":s.registration.status==="diverifikasi","bg-red-50 text-red-700 border-red-100":s.registration.status==="ditolak"}])},[s.registration.status==="pending"?(t(),L(P,{key:0,name:"clock",class:"w-4 h-4"})):s.registration.status==="diverifikasi"?(t(),L(P,{key:1,name:"check-circle",class:"w-4 h-4"})):(t(),L(P,{key:2,name:"x-circle",class:"w-4 h-4"})),U(" STATUS: "+b((g=s.registration.status)==null?void 0:g.toUpperCase()),1)],2)])]),e("div",et,[e("div",tt,[e("div",st,[e("div",at,[$(P,{name:"building-office-2",class:"w-8 h-8"})]),e("div",null,[r[2]||(r[2]=e("p",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2"},"SEKOLAH TUJUAN",-1)),e("h3",ot,b((S=s.registration.school)==null?void 0:S.nama_sekolah),1)])]),r[4]||(r[4]=e("div",{class:"hidden md:block w-px h-24 border-r-2 border-dashed border-gray-200"},null,-1)),r[5]||(r[5]=e("div",{class:"md:hidden w-full h-px border-b-2 border-dashed border-gray-200"},null,-1)),e("div",lt,[r[3]||(r[3]=e("p",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3"},"NO. PENDAFTARAN",-1)),e("div",nt,[e("span",rt,b(s.registration.registration_number),1),e("button",{onClick:a,class:"p-2 hover:bg-white rounded-lg text-gray-400 hover:text-indigo-600 transition-all shadow-sm",title:"Salin Nomor"},[$(P,{name:"document-duplicate",class:"w-5 h-5"})])])])])]),e("div",it,[e("div",dt,[r[6]||(r[6]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Berkas Persyaratan",-1)),e("span",ct,b(p(h).length)+" Dokumen",1)]),r[8]||(r[8]=e("div",{class:"hidden md:grid grid-cols-12 gap-4 px-6 text-xs font-bold text-gray-400 uppercase tracking-wider"},[e("div",{class:"col-span-5"},"NAMA DOKUMEN"),e("div",{class:"col-span-4 text-center"},"STATUS"),e("div",{class:"col-span-3 text-right"},"AKSI")],-1)),e("div",ut,[(t(!0),i(A,null,I(p(h),(c,ee)=>{var H,J;return t(),i("div",{key:ee,class:"group bg-white rounded-xl border border-transparent shadow-sm hover:shadow-md hover:border-indigo-100 transition-all duration-200 dark:bg-boxdark dark:border-strokedark"},[e("div",mt,[e("div",ft,[e("h4",gt,b((J=(H=c.path_requirement)==null?void 0:H.document_type)==null?void 0:J.label),1),c.status==="ditolak"?(t(),i("p",pt,[$(P,{name:"exclamation-circle",class:"w-4 h-4"}),U(" "+b(c.alasan_reject),1)])):B("",!0)]),e("div",ht,[e("span",{class:N(["inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-bold whitespace-nowrap capitalize",{"bg-yellow-50 text-yellow-600":c.status==="menunggu verifikasi"||c.status==="belum upload","bg-green-50 text-green-600":c.status==="diverifikasi","bg-red-50 text-red-600":c.status==="ditolak"}])},[e("span",{class:N(["w-1.5 h-1.5 rounded-full",{"bg-yellow-400":c.status==="menunggu verifikasi"||c.status==="belum upload","bg-green-500":c.status==="diverifikasi","bg-red-500":c.status==="ditolak"}])},null,2),U(" "+b(c.status==="belum upload"?"Belum Upload":c.status),1)],2)]),e("div",vt,[c.path?(t(),i("a",{key:0,href:c.url_path??"",target:"_blank",class:"p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Lihat Dokumen"},[$(P,{name:"eye",class:"w-5 h-5"})],8,xt)):(t(),i("span",kt,[$(P,{name:"eye",class:"w-5 h-5"})])),c.status!=="diverifikasi"?(t(),i("button",{key:2,onClick:Xt=>o(c.id,c.status==="ditolak"?"revisi":"upload"),class:"flex items-center gap-2 px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all shadow-indigo-200 hover:shadow-indigo-300 shadow-sm text-sm font-bold min-w-[100px] justify-center"},[$(P,{name:"arrow-up-tray",class:"w-4 h-4"}),U(" "+b(c.status==="ditolak"?"Revisi":"Upload"),1)],8,bt)):(t(),i("div",_t,[$(P,{name:"check-circle",class:"w-5 h-5"}),r[7]||(r[7]=e("span",null,"Verified",-1))]))])])])}),128))])])]),$(Qe,{show:u.value,title:w.value==="upload"?"Upload Dokumen":"Revisi Dokumen",subtitle:`Lampirkan file untuk ${m.value}`,loading:p(n),onClose:M,onUpload:T},null,8,["show","title","subtitle","loading"])],64)}}}),wt={},$t={class:"rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1"};function Dt(s,f){return t(),i("div",$t,f[0]||(f[0]=[ne('<div class="hero bg-base-200 min-h-screen"><div class="hero-content text-center"><div class="max-w-md"><h1 class="text-5xl font-bold">Halo calon siswa</h1><p class="py-6">Saat ini PPDB belum mengadakan pendaftaran.</p></div></div></div>',1)]))}const St=Q(wt,[["render",Dt]]),Pt={class:"hero bg-white max-h-screen"},Ct=j({__name:"NoPendaftar",setup(s){return(f,x)=>(t(),i("div",Pt,[$(ve,{title:"Belum ada pendaftar",message:"Belum ada pendaftar"})]))}}),Bt={key:1,class:"rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1"},Lt={class:"flex justify-between items-center mb-6"},Tt={key:0,class:"text-black dark:text-white"},Mt={class:"overflow-x-auto"},jt={class:"table"},Et={class:"flex items-center gap-3"},Ut={class:"avatar"},Vt={class:"mask mask-squircle h-12 w-12"},Nt=["src","alt"],At={class:"text-black dark:text-white font-medium font-semibold"},Ft={class:"text-center"},Rt={class:"flex flex-col items-center justify-center text-center align-middle py-5 px-4"},Ot={key:0,class:"badge badge-warning"},It={class:"py-5 px-4"},Kt={class:"flex items-center space-x-3.5"},zt={class:"tooltip","data-tip":"Lihat"},Ht=["href"],Jt={key:1,class:"flex items-center cursor-not-allowed text-gray-400"},qt={class:"tooltip","data-tip":"Verifikasi"},Gt=["onClick","disabled"],Zt=j({__name:"SekolahDaftar",setup(s){const{loadingPendaftar:f,dataPendaftar:x,fetchPendaftar:D,loadingVerifikasi:h,verifikasiPendaftaran:l,totalPendaftar:u}=X(),d=_(null),m=_(""),k=v=>{var n;m.value="",(n=d.value)==null||n.show(),m.value=v},w=async()=>{var n;const v=await l(m.value);if(v.success){(n=d.value)==null||n.close();let o=he(x.value,m.value);o&&(o.status=v.data.status,o.verified_by=v.data.verified_by),V({type:"success",message:"Verifikasi pendaftaran berhasil"})}else V({type:"error",message:"Verifikasi pendaftaran gagal, "+v.message})},y=()=>{var v;m.value="",(v=d.value)==null||v.close()};return F(()=>{D()}),(v,n)=>{var o;return t(),i(A,null,[((o=p(x))==null?void 0:o.length)===0?(t(),L(Ct,{key:0})):(t(),i("div",Bt,[e("div",Lt,[n[0]||(n[0]=e("h2",{class:"text-xl font-semibold text-black dark:text-white"},"Daftar Siswa Pendaftar",-1)),p(u)?(t(),i("p",Tt,"Total "+b(p(u))+" Calon Siswa",1)):B("",!0)]),e("div",Mt,[e("table",jt,[n[2]||(n[2]=e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"Name"),e("th",{class:"text-center"},"NISN"),e("th",{class:"text-center"},"Status"),e("th")])],-1)),e("tbody",null,[p(f)?(t(),i(A,{key:0},I(2,a=>e("tr",{key:a},n[1]||(n[1]=[e("td",null,[e("div",{class:"flex items-center gap-3"},[e("div",{class:"avatar"},[e("div",{class:"skeleton rounded-full h-12 w-12"})]),e("div",null,[e("div",{class:"skeleton h-4 w-24 rounded"}),e("div",{class:"skeleton h-4 w-24 rounded mt-2"})])])],-1),e("td",null,[e("span",{class:"skeleton h-4 w-36 rounded block"})],-1),e("td",{class:"text-center"},[e("button",{class:"btn btn-ghost btn-xs"},"Status")],-1),e("td",null,null,-1)]))),64)):(t(!0),i(A,{key:1},I(p(x),(a,T)=>{var M,C,r,g,S;return t(),i("tr",{key:T},[e("td",null,[e("div",Et,[e("div",Ut,[e("div",Vt,[e("img",{src:(M=a==null?void 0:a.student)==null?void 0:M.thumbnail_url,alt:`Foto ${(C=a==null?void 0:a.student)==null?void 0:C.nama}`,class:"rounded-full h-12 w-12"},null,8,Nt)])]),e("div",null,[e("div",At,b((r=a==null?void 0:a.student)==null?void 0:r.nama),1),e("div",null,b(a.registration_number),1)])])]),e("td",Ft,b((g=a==null?void 0:a.student)==null?void 0:g.nisn),1),e("td",Rt,[e("div",null,b(a==null?void 0:a.status),1),(a==null?void 0:a.status)==="diverifikasi"?(t(),i("div",Ot,b((S=a.verified_by)==null?void 0:S.username),1)):B("",!0)]),e("td",It,[e("div",Kt,[e("div",zt,[a.id?(t(),i("a",{key:0,href:`/pendaftaran/verifikasi/${a.id}`,class:"flex items-center hover:text-primary",target:"_blank",rel:"noopener noreferrer"},[$(P,{name:"view-finder",size:"18",class:"h-5 w-5"})],8,Ht)):(t(),i("span",Jt,[$(P,{name:"view-finder",size:"18",class:"h-5 w-5"})]))]),e("div",qt,[e("button",{class:"flex items-center hover:text-primary",onClick:c=>k(a.id),disabled:(a==null?void 0:a.status)==="diverifikasi"},[$(P,{name:"document-check",size:"18",class:"h-5 w-5"})],8,Gt)])])])])}),128))])])])])),$(pe,{ref_key:"verifikasiModal",ref:d,title:"Verifikasi pendaftaran",message:"Apakah anda yakin ingin verifikasi pendafataran ini?",confirmLabel:"Verifikasi",cancelLabel:"Batal",loading:p(h),confirmHandler:w,cancelHandler:y},null,8,["loading"])],64)}}}),Qt={class:"mx-auto"},Yt={key:0},Wt={key:1},vs=j({__name:"PendaftaranView",setup(s){const f=_("Pendaftaran"),x=R(),{fetchRegistration:D,loadingRegistration:h,registrationData:l}=ae(),u=Y(),d={BelumDaftar:O(je),SudahDaftar:O(yt),BelumBukaPendaftaran:O(St),SekolahDaftar:O(Zt)},m=_(null),k=_(0);F(async()=>{x.clearErrors();const y=u.role;if(y==="siswa")try{(await D()).success?m.value=l.value!==null?d.SudahDaftar:d.BelumDaftar:m.value=d.BelumBukaPendaftaran}catch{}else(y==="sekolah"||y==="verifikator_sekolah")&&(m.value=d.SekolahDaftar)});function w(y){l.value=y,m.value=d.SudahDaftar}return F(async()=>{await ge()}),(y,v)=>(t(),L(se,null,{default:re(()=>[e("div",Qt,[$(te,{pageTitle:f.value},null,8,["pageTitle"]),p(h)?(t(),i("div",Yt,v[0]||(v[0]=[e("p",null,"Loading...",-1),e("svg",{class:"animate-spin h-5 w-5 text-blue-500",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 0116 0 8 8 0 11-16 0z"})],-1)]))):(t(),i("div",Wt,[(t(),L(ie(m.value),{registration:p(l),key:k.value,onRefreshParent:w},null,40,["registration"]))]))])]),_:1}))}});export{vs as default};
