import{d as B,h as v,A as C,P as $,o as q,a as d,p as K,w as P,e as o,u as w,c as m,b as n,C as f,t as p,f as V,g as b,j as T,D as A,H as E,F,k as I,q as M,B as x}from"../index.js";import{_ as G,a as L}from"./DefaultLayout.vue_vue_type_script_setup_true_lang.RdvziuN4.js";import{I as i}from"./InputGroup.CGOI8iZn.js";import{a as H}from"./useSekolah.BeRg058J.js";import{u as J}from"./useKecamatan.BULQhWxi.js";import"./authComposable.sKl44bRY.js";import"./logo-ppdb.BW9ypDwz.js";const R={key:0,class:"flex justify-center py-20"},z={key:1,class:"flex flex-col items-center justify-center py-20 text-gray-500"},O={key:2,class:"max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},Q={class:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50"},W={class:"text-xl font-bold text-gray-900"},X={class:"text-sm text-gray-500"},Y={class:"flex gap-2"},Z={class:"p-6"},ee={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},ae={class:"flex flex-col gap-1"},le=["disabled"],te=["value"],se={key:0,class:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-100"},ne=["disabled"],oe={key:0,class:"loading loading-spinner loading-xs mr-2"},ke=B({__name:"SekolahDetailView",setup(ie){const k=M(),{fetchSekolahById:_,updateSekolah:c,loadingSekolah:S}=H(),{kecamatanList:j,fetchKecamatan:h}=J(),u=v(null),t=v("view"),r=v(!1),D=C(()=>t.value==="edit"?"Edit Data Sekolah":"Detail Data Sekolah"),a=$({nama_sekolah:"",nss:"",npsn:"",jenjang:"",alamat:"",no_telp:"",email:"",nama_kepsek:"",kecamatan_id:"",daya_tampung:"",username:"",password:""}),U=s=>{var e,l,y;a.nama_sekolah=s.nama_sekolah||"",a.nss=s.nss||"",a.npsn=s.npsn||"",a.jenjang=s.jenjang||"",a.alamat=s.alamat||"",a.no_telp=s.no_telp||"",a.email=s.email||"",a.nama_kepsek=s.nama_kepsek||"",a.kecamatan_id=(s.kecamatan_id||((e=s.kecamatan)==null?void 0:e.id)||"").toString(),a.daya_tampung=((l=s.daya_tampung)==null?void 0:l.toString())||"",a.username=((y=s.user)==null?void 0:y.username)||"",a.password=""},g=async()=>{const s=k.params.id;if(s){const e=await _(s);e&&(u.value=e,U(e))}},N=async()=>{if(!u.value)return;r.value=!0;const s=await c(u.value.id,{...a});r.value=!1,s?(x({message:"Data sekolah berhasil diperbarui"}),t.value="view",g()):x({message:"Gagal memperbarui data sekolah",type:"error"})};return q(async()=>{k.query.mode==="edit"&&(t.value="edit"),await h(),await g()}),(s,e)=>(d(),K(L,null,{default:P(()=>[o(G,{"page-title":D.value},null,8,["page-title"]),w(S)?(d(),m("div",R,e[16]||(e[16]=[n("span",{class:"loading loading-spinner loading-lg text-primary"},null,-1)]))):u.value?(d(),m("div",O,[n("div",Q,[n("div",null,[n("h2",W,p(u.value.nama_sekolah),1),n("p",X,"NPSN: "+p(u.value.npsn)+" | NSS: "+p(u.value.nss),1)]),n("div",Y,[t.value==="view"?(d(),m("button",{key:0,onClick:e[1]||(e[1]=l=>t.value="edit"),class:"btn btn-sm btn-outline btn-primary"},[o(f,{name:"document-text",class:"w-4 h-4 mr-1"}),e[18]||(e[18]=V(" Edit "))])):b("",!0),t.value==="edit"?(d(),m("button",{key:1,onClick:e[2]||(e[2]=l=>t.value="view"),class:"btn btn-sm btn-ghost"}," Batal ")):b("",!0)])]),n("div",Z,[n("form",{onSubmit:T(N,["prevent"])},[n("div",ee,[o(i,{modelValue:a.nama_sekolah,"onUpdate:modelValue":e[3]||(e[3]=l=>a.nama_sekolah=l),label:"Nama Sekolah",name:"nama_sekolah",required:"",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.nama_kepsek,"onUpdate:modelValue":e[4]||(e[4]=l=>a.nama_kepsek=l),label:"Kepala Sekolah",name:"nama_kepsek",required:"",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.nss,"onUpdate:modelValue":e[5]||(e[5]=l=>a.nss=l),label:"NSS",name:"nss",inputmode:"numeric",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.npsn,"onUpdate:modelValue":e[6]||(e[6]=l=>a.npsn=l),label:"NPSN",name:"npsn",inputmode:"numeric",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.jenjang,"onUpdate:modelValue":e[7]||(e[7]=l=>a.jenjang=l),label:"Jenjang",name:"jenjang",required:"",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.daya_tampung,"onUpdate:modelValue":e[8]||(e[8]=l=>a.daya_tampung=l),label:"Daya Tampung",name:"daya_tampung",inputmode:"numeric",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.no_telp,"onUpdate:modelValue":e[9]||(e[9]=l=>a.no_telp=l),label:"No. Telepon",name:"no_telp",inputmode:"tel",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.email,"onUpdate:modelValue":e[10]||(e[10]=l=>a.email=l),label:"Email Sekolah",name:"email",type:"email",required:"",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.alamat,"onUpdate:modelValue":e[11]||(e[11]=l=>a.alamat=l),label:"Alamat",name:"alamat",required:"",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.username,"onUpdate:modelValue":e[12]||(e[12]=l=>a.username=l),label:"Username Akun",name:"username",disabled:t.value==="view"},null,8,["modelValue","disabled"]),o(i,{modelValue:a.password,"onUpdate:modelValue":e[13]||(e[13]=l=>a.password=l),label:"Password Akun (Isi jika ingin mengubah)",name:"password",type:"password",disabled:t.value==="view",placeholder:"Kosongkan jika tidak ingin mengubah"},null,8,["modelValue","disabled"]),n("div",ae,[e[20]||(e[20]=n("label",{class:"mb-1 block text-black"},"Kecamatan",-1)),A(n("select",{"onUpdate:modelValue":e[14]||(e[14]=l=>a.kecamatan_id=l),class:"w-full rounded border-[1.5px] border-stroke bg-white px-5 py-3 text-black outline-none transition focus:border-primary active:border-primary disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:t.value==="view"},[e[19]||(e[19]=n("option",{value:"",disabled:""},"Pilih Kecamatan",-1)),(d(!0),m(F,null,I(w(j),l=>(d(),m("option",{key:l.id,value:l.id},p(l.nama),9,te))),128))],8,le),[[E,a.kecamatan_id]])])]),t.value==="edit"?(d(),m("div",se,[n("button",{type:"button",onClick:e[15]||(e[15]=l=>t.value="view"),class:"btn btn-ghost"},"Batal"),n("button",{type:"submit",class:"btn btn-primary text-white",disabled:r.value},[r.value?(d(),m("span",oe)):b("",!0),e[21]||(e[21]=V(" Simpan Perubahan "))],8,ne)])):b("",!0)],32)])])):(d(),m("div",z,[o(f,{name:"exclamation-circle",class:"h-16 w-16 mb-4 text-gray-400"}),e[17]||(e[17]=n("p",{class:"text-xl font-semibold"},"Data Sekolah Tidak Ditemukan",-1)),n("button",{onClick:e[0]||(e[0]=l=>s.$router.push({name:"masterSekolah"})),class:"btn btn-primary mt-4 text-white"}," Kembali ke Master Data ")]))]),_:1}))}});export{ke as default};
