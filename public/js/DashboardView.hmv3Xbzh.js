import{d as k,h as A,A as C,o as U,B as T,a,c as r,e as s,u as n,p as w,b as e,n as M,C as p,t as m,w as y,D as I,E as R,F as j,G as H,f as Q,g as te,r as ae,k as O,v as q,l as se,H as ne,I as W,J as z,K as le}from"../index.js";import{u as X,_ as V}from"./useStatistik.C9OvlNw-.js";import{_ as Y}from"./LoadingInfoComponent.vue_vue_type_script_setup_true_lang.Dx7bmB2e.js";import{u as Z}from"./usePendaftaran.DplSNUYV.js";import{_ as ee,n as oe,a as re}from"./DefaultLayout.vue_vue_type_script_setup_true_lang.RdvziuN4.js";import{_ as ie}from"./TabelSekolahWithDataComponent.vue_vue_type_script_setup_true_lang.DcH4QasI.js";import{_ as de}from"./ModalComponent.vue_vue_type_script_setup_true_lang.UEeJILJd.js";import{u as ce}from"./useCekPendaftaran.D3hBySMT.js";import{_ as ue}from"./SpinnerLoading.vue_vue_type_script_setup_true_lang.CQvHfLuO.js";import"./authComposable.sKl44bRY.js";import"./logo-ppdb.BW9ypDwz.js";import"./NoDataComponent.vue_vue_type_script_setup_true_lang.0N8bNYdP.js";import"./useSekolah.BeRg058J.js";import"./buatOption.BTQFN8sK.js";import"./useKecamatan.BULQhWxi.js";import"./jenjang.DlmV0PPG.js";import"./FilterSelect.B9v0oc3M.js";import"./index.BB3keK1r.js";const ge={key:1,class:"space-y-6"},me={class:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm flex flex-col md:flex-row items-center justify-between gap-4"},_e={class:"flex items-center gap-4"},pe={class:"text-sm text-gray-500"},he={key:0,class:"font-medium text-green-600"},be={key:1,class:"font-medium text-red-500"},fe=["disabled"],xe={class:"grid grid-cols-2 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"},ve={class:"row mt-4"},ye={class:"space-y-4 py-4"},we={class:"form-control"},ke={class:"grid grid-cols-2 gap-4"},$e={class:"form-control"},Se={class:"form-control"},De=k({__name:"DashboardAdmin",setup(f){const{statistik:t,fetchStatistik:o,error:i,loadingStatistik:h}=X(),{bukaPendaftaran:u,tutupPendaftaran:d,loadingPendaftar:g}=Z(),x=A(null),l=A({tahun_ajaran:"",start_date:"",end_date:""}),_=C(()=>{var b,c;return((b=t.value)==null?void 0:b.tahun_ajaran)!=="-"&&((c=t.value)==null?void 0:c.tahun_ajaran)!==void 0});U(()=>{$()});const $=()=>{o(),i.value&&T({message:(i==null?void 0:i.toString())??"An unknown error occurred",type:"error"})},S=()=>{var b;l.value={tahun_ajaran:"",start_date:new Date().toISOString().split("T")[0],end_date:""},(b=x.value)==null||b.show()},D=async()=>{if(confirm("Apakah anda yakin ingin menutup tahun ajaran ini?")){const b=await d();b.success?(T({message:"Pendaftaran berhasil ditutup",type:"success"}),$()):T({message:b.message??"Gagal menutup pendaftaran",type:"error"})}},B=async()=>{var c;const b=await u(l.value);b.id?(T({message:"Tahun ajaran berhasil dibuka",type:"success"}),(c=x.value)==null||c.close(),$()):T({message:b.message??"Gagal membuka pendaftaran",type:"error"})};return(b,c)=>{var P,v,G,J,K,E,F;return a(),r(j,null,[s(ee,{pageTitle:"Dashboard"}),n(h)?(a(),w(Y,{key:0})):(a(),r("div",ge,[e("div",me,[e("div",_e,[e("div",{class:M(["p-3 rounded-full",_.value?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[s(p,{name:"calendar",class:"w-8 h-8"})],2),e("div",null,[c[3]||(c[3]=e("h3",{class:"font-bold text-gray-800 text-lg"},"Status Tahun Ajaran",-1)),e("div",pe,[_.value?(a(),r("span",he,"Aktif: "+m((P=n(t))==null?void 0:P.tahun_ajaran)+" ("+m((v=n(t))==null?void 0:v.periode)+")",1)):(a(),r("span",be,"Tidak ada tahun ajaran aktif"))])])]),e("div",null,[_.value?(a(),r("button",{key:0,onClick:D,disabled:n(g),class:"btn btn-error text-white btn-sm px-6"}," Tutup Pendaftaran ",8,fe)):(a(),r("button",{key:1,onClick:S,class:"btn btn-primary text-white btn-sm px-6"}," Buka Pendaftaran Baru "))])]),e("div",xe,[s(V,{icon:"document-check",label:"Sekolah",value:(G=n(t))==null?void 0:G.sekolah,color:"blue"},null,8,["value"]),s(V,{icon:"document-check",label:"SD",value:(J=n(t))==null?void 0:J.sd,color:"orange"},null,8,["value"]),s(V,{icon:"document-check",label:"SMP",value:(K=n(t))==null?void 0:K.smp,color:"orange"},null,8,["value"]),s(V,{icon:"calendar",label:(E=n(t))==null?void 0:E.periode,value:(F=n(t))==null?void 0:F.tahun_ajaran,color:"orange"},null,8,["label","value"])]),e("div",ve,[s(ie)]),s(de,{ref_key:"modalOpen",ref:x,title:"Buka Tahun Ajaran Baru",confirmLabel:"Buka Pendaftaran",confirmHandler:B,loading:n(g)},{default:y(()=>[e("div",ye,[e("div",we,[c[4]||(c[4]=e("label",{class:"label"},[e("span",{class:"label-text"},"Tahun Ajaran")],-1)),I(e("input",{"onUpdate:modelValue":c[0]||(c[0]=L=>l.value.tahun_ajaran=L),type:"text",placeholder:"Contoh: 2025/2026",class:"input input-bordered w-full"},null,512),[[R,l.value.tahun_ajaran]])]),e("div",ke,[e("div",$e,[c[5]||(c[5]=e("label",{class:"label"},[e("span",{class:"label-text"},"Tanggal Mulai")],-1)),I(e("input",{"onUpdate:modelValue":c[1]||(c[1]=L=>l.value.start_date=L),type:"date",class:"input input-bordered w-full"},null,512),[[R,l.value.start_date]])]),e("div",Se,[c[6]||(c[6]=e("label",{class:"label"},[e("span",{class:"label-text"},"Tanggal Selesai")],-1)),I(e("input",{"onUpdate:modelValue":c[2]||(c[2]=L=>l.value.end_date=L),type:"date",class:"input input-bordered w-full"},null,512),[[R,l.value.end_date]])])])])]),_:1},8,["loading"])]))],64)}}}),Te={class:"rounded-2xl bg-white p-6 shadow-sm border border-gray-100 flex flex-col justify-between h-full relative overflow-hidden"},Ce={class:"flex items-center gap-3 mb-4"},je={class:"font-bold text-gray-500 uppercase tracking-wider text-xs"},Pe={class:"text-4xl font-extrabold text-gray-800 mb-4"},N=k({__name:"DashboardSummaryCard",props:{title:{},value:{},variant:{},tagLabel:{}},setup(f){const t=f,o=C(()=>{switch(t.variant){case"blue":return"bg-blue-100 text-blue-600";case"green":return"bg-green-100 text-green-600";case"red":return"bg-red-100 text-red-600";default:return"bg-gray-100 text-gray-600"}}),i=C(()=>{switch(t.variant){case"blue":return"bg-blue-50 text-blue-600 border border-blue-100";case"green":return"bg-green-50 text-green-600 border border-green-100";case"red":return"bg-red-50 text-red-600 border border-red-100";default:return"bg-gray-50 text-gray-600"}}),h=C(()=>{switch(t.variant){case"blue":return"bg-blue-50 text-blue-600";case"green":return"bg-green-50 text-green-700";case"red":return"bg-red-50 text-red-600";default:return"bg-gray-50 text-gray-600"}});return(u,d)=>(a(),r("div",Te,[e("div",{class:M(["absolute -top-6 -right-6 h-24 w-24 rounded-full opacity-30",o.value])},null,2),e("div",null,[e("div",Ce,[e("span",{class:M(["rounded-lg p-2",i.value])},[H(u.$slots,"icon")],2),e("h3",je,m(u.title),1)]),e("div",Pe,m(u.value),1)]),u.tagLabel?(a(),r("div",{key:0,class:M(["inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium w-fit",h.value])},[H(u.$slots,"tag-icon"),Q(" "+m(u.tagLabel),1)],2)):te("",!0)]))}}),Le={class:"rounded-2xl bg-white p-6 shadow-sm border border-gray-100 h-full flex flex-col"},Ae={class:"flex items-center gap-3 mb-6"},Be={class:"space-y-4 flex-grow"},Ve={class:"flex items-center justify-between p-4 rounded-xl bg-orange-50 border border-orange-100"},Me={class:"flex items-center gap-3"},Ie={class:"p-2 bg-white rounded-full text-orange-500 shadow-sm"},Oe={class:"text-xl font-bold text-gray-800"},Re={class:"flex items-center justify-between p-4 rounded-xl bg-blue-50 border border-blue-100"},ze={class:"flex items-center gap-3"},Ne={class:"p-2 bg-white rounded-full text-blue-600 shadow-sm"},Ue={class:"text-xl font-bold text-gray-800"},Ge={class:"flex items-center justify-between p-4 rounded-xl bg-gray-50 border border-gray-100"},Je={class:"flex items-center gap-3"},Ke={class:"p-2 bg-white rounded-full text-gray-400 shadow-sm"},Ee={class:"text-xl font-bold text-gray-500"},Fe={class:"mt-6"},He=k({__name:"ValidationStatusCard",props:{pending:{},valid:{},ditolak:{}},setup(f){return(t,o)=>{const i=ae("RouterLink");return a(),r("div",Le,[e("div",Ae,[s(p,{name:"document-text",class:"text-gray-400 w-6 h-6"}),o[0]||(o[0]=e("h3",{class:"font-bold text-gray-800 text-lg"},"Status Validasi",-1))]),e("div",Be,[e("div",Ve,[e("div",Me,[e("div",Ie,[s(p,{name:"clock",class:"w-5 h-5"})]),o[1]||(o[1]=e("div",null,[e("div",{class:"font-bold text-gray-800"},"Pending"),e("div",{class:"text-xs text-gray-500"},"Menunggu cek")],-1))]),e("div",Oe,m(t.pending),1)]),e("div",Re,[e("div",ze,[e("div",Ne,[s(p,{name:"document-check",class:"w-5 h-5"})]),o[2]||(o[2]=e("div",null,[e("div",{class:"font-bold text-gray-800"},"Valid"),e("div",{class:"text-xs text-gray-500"},"Terverifikasi")],-1))]),e("div",Ue,m(t.valid),1)]),e("div",Ge,[e("div",Je,[e("div",Ke,[s(p,{name:"x-circle",class:"w-5 h-5"})]),o[3]||(o[3]=e("div",null,[e("div",{class:"font-bold text-gray-500"},"Ditolak"),e("div",{class:"text-xs text-gray-400"},"Data invalid")],-1))]),e("div",Ee,m(t.ditolak),1)])]),e("div",Fe,[s(i,{to:"/pendaftaran",class:"block w-full text-center py-3 rounded-xl border border-gray-200 font-bold text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors"},{default:y(()=>o[4]||(o[4]=[Q(" Kelola Data ")])),_:1})])])}}}),qe={class:"rounded-2xl bg-white p-6 shadow-sm border border-gray-100 h-full flex flex-col"},Qe={class:"flex items-center justify-between mb-6"},We={class:"flex items-center gap-3"},Xe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"},Ye={class:"mb-3 text-purple-600"},Ze={class:"text-3xl font-extrabold text-gray-800 mb-1"},et={class:"text-xs font-bold text-gray-400 uppercase tracking-widest text-center"},tt={class:"mt-auto"},at={class:"flex justify-between items-center mb-2"},st={class:"text-xs font-bold text-gray-400"},nt={class:"h-3 w-full bg-gray-100 rounded-full overflow-hidden flex"},lt={class:"flex flex-wrap gap-4 mt-4"},ot={class:"text-xs font-medium text-gray-500"},rt=k({__name:"JalurMasukStatsCard",props:{data:{}},setup(f){const t=f,o=C(()=>Object.values(t.data).reduce((d,g)=>d+g,0)),i=d=>o.value===0?0:d/o.value*100,h=["#6366f1","#ec4899","#8b5cf6","#06b6d4","#10b981","#f59e0b"],u=d=>h[d%h.length];return(d,g)=>(a(),r("div",qe,[e("div",Qe,[e("div",We,[s(p,{name:"map-pin",class:"text-gray-400 w-6 h-6"}),g[0]||(g[0]=e("h3",{class:"font-bold text-gray-800 text-lg"},"Statistik Jalur Masuk",-1))]),g[1]||(g[1]=e("button",{class:"text-sm font-bold text-blue-600 hover:underline"},"Lihat Detail",-1))]),e("div",Xe,[(a(!0),r(j,null,O(d.data,(x,l)=>(a(),r("div",{key:l,class:"flex flex-col items-center justify-center p-6 rounded-2xl bg-white border border-gray-100 shadow-sm hover:shadow-md transition-shadow"},[e("div",Ye,[String(l).toLowerCase().includes("zonasi")?(a(),w(p,{key:0,name:"map-pin",class:"w-6 h-6"})):String(l).toLowerCase().includes("afirmasi")?(a(),w(p,{key:1,name:"heart",class:"w-6 h-6 text-pink-500"})):String(l).toLowerCase().includes("prestasi")?(a(),w(p,{key:2,name:"star",class:"w-6 h-6 text-yellow-500"})):(a(),w(p,{key:3,name:"user-group",class:"w-6 h-6 text-blue-500"}))]),e("div",Ze,m(x),1),e("div",et,m(l),1)]))),128))]),e("div",tt,[e("div",at,[g[2]||(g[2]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"DISTRIBUSI",-1)),e("span",st,"TOTAL: "+m(o.value),1)]),e("div",nt,[(a(!0),r(j,null,O(d.data,(x,l,_)=>(a(),r("div",{key:l,style:q({width:i(x)+"%",backgroundColor:u(_)}),class:"h-full"},null,4))),128))]),e("div",lt,[(a(!0),r(j,null,O(d.data,(x,l,_)=>(a(),r("div",{key:l,class:"flex items-center gap-2"},[e("div",{class:"w-2 h-2 rounded-full",style:q({backgroundColor:u(_)})},null,4),e("span",ot,m(l)+" ("+m(Math.round(i(x)))+"%) ",1)]))),128))])])]))}}),it={class:"flex flex-col gap-4 mb-6"},dt={class:"form-control w-full sm:w-auto"},ct=["value"],ut={key:1,class:"space-y-6"},gt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},mt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},_t={class:"lg:col-span-1"},pt={class:"lg:col-span-2"},ht=k({__name:"DashboardSekolah",setup(f){const{statistik:t,fetchStatistik:o,error:i,loadingStatistik:h}=X(),{fetchAllPeriods:u}=Z(),d=A([]),g=A("");U(async()=>{d.value=await u();const l=d.value.find(_=>_.is_open);l&&(g.value=l.id),o({period_id:g.value}),i.value&&T({message:(i==null?void 0:i.value)??"An unknown error occurred",type:"error"})}),se(g,l=>{o({period_id:l})});const x=C(()=>{var S,D;const l=((S=t.value)==null?void 0:S.lulus)??0,_=((D=t.value)==null?void 0:D.daya_tampung)??0;return!_||_===0?"Kuota belum ditentukan":`${Math.round(l/_*100)}% dari kuota terpenuhi`});return(l,_)=>{var $,S,D,B,b,c,P;return a(),r(j,null,[e("div",it,[s(ee,{pageTitle:"Dashboard"}),e("div",dt,[I(e("select",{"onUpdate:modelValue":_[0]||(_[0]=v=>g.value=v),class:"select select-bordered w-full max-w-xs"},[_[1]||(_[1]=e("option",{disabled:"",value:""},"Pilih Tahun Ajaran",-1)),(a(!0),r(j,null,O(d.value,v=>(a(),r("option",{key:v.id,value:v.id},m(v.tahun_ajaran)+" ("+m(v.is_open?"Aktif":"Tutup")+") ",9,ct))),128))],512),[[ne,g.value]])])]),n(h)?(a(),w(Y,{key:0})):(a(),r("div",ut,[e("div",gt,[s(N,{title:"Total Pendaftar",value:(($=n(t))==null?void 0:$.pendaftar)??0,variant:"blue",tagLabel:"Data masuk hari ini"},{icon:y(()=>[s(p,{name:"user-group",class:"w-6 h-6"})]),"tag-icon":y(()=>[s(p,{name:"arrow-trending-up",class:"w-4 h-4"})]),_:1},8,["value"]),s(N,{title:"Lulus Seleksi",value:((S=n(t))==null?void 0:S.lulus)??0,variant:"green",tagLabel:x.value},{icon:y(()=>[s(p,{name:"academic-cap",class:"w-6 h-6"})]),"tag-icon":y(()=>[s(p,{name:"check-circle",class:"w-4 h-4"})]),_:1},8,["value","tagLabel"]),s(N,{title:"Tidak Lulus",value:((D=n(t))==null?void 0:D.tidak_lulus)??0,variant:"red",tagLabel:"Perlu tindak lanjut admin"},{icon:y(()=>[s(p,{name:"x-circle",class:"w-6 h-6"})]),"tag-icon":y(()=>[s(p,{name:"exclamation-circle",class:"w-4 h-4"})]),_:1},8,["value"])]),e("div",mt,[e("div",_t,[s(He,{pending:((B=n(t))==null?void 0:B.pending)??0,valid:((b=n(t))==null?void 0:b.diverifikasi)??0,ditolak:((c=n(t))==null?void 0:c.ditolak)??0},null,8,["pending","valid","ditolak"])]),e("div",pt,[s(rt,{data:((P=n(t))==null?void 0:P.jumlah_per_jalur)??{}},null,8,["data"])])])]))],64)}}}),bt={class:"flex overflow-hidden rounded-xl bg-white shadow-sm transition-all duration-300 hover:-translate-y-1 hover:shadow-lg border border-gray-100"},ft={class:"flex-1 p-6"},xt={class:"mb-2 text-xl font-bold text-gray-800"},vt={class:"inline-block rounded-full bg-blue-100 px-3 py-1 text-xs font-medium text-blue-600 mb-2"},yt={class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},wt={class:"h-48 w-48 shrink-0"},kt=["src"],$t=k({__name:"PhotoCard",props:{nameText:String,username:String,tanggal_lahir:String,photo_url:String,role:String},setup(f){return(t,o)=>(a(),r("article",bt,[e("div",ft,[e("p",xt,m(f.nameText),1),e("span",vt,m(f.role),1),e("p",yt,m(f.username),1)]),e("div",wt,[e("img",{alt:"",src:f.photo_url||n(oe),class:"h-full w-full object-cover"},null,8,kt)])]))}}),St={class:"rounded-2xl border border-gray-100 bg-white p-6 h-32 shadow-md transition hover:shadow-lg"},Dt={class:"flex items-center justify-between"},Tt={key:1},Ct={key:0},jt={key:1,class:"mr-2"},Pt={class:"text-sm text-gray-500"},Lt={class:"text-2xl font-medium text-gray-900"},At={class:"rounded-full bg-blue-100 p-3 text-blue-600"},Bt=k({__name:"InfoPendaftaranCard",setup(f){const{fetchRegistration:t,loadingRegistration:o,registrationData:i}=ce();return U(()=>{t()}),(h,u)=>{var d,g,x;return a(),r("article",St,[e("div",Dt,[n(o)?(a(),w(ue,{key:0,size:"lg",loading:!0})):(a(),r("div",Tt,[n(i)?(a(),r("div",jt,[e("p",Pt,m((d=n(i))==null?void 0:d.registration_number),1),e("p",Lt,m((x=(g=n(i))==null?void 0:g.school)==null?void 0:x.nama_sekolah),1)])):(a(),r("div",Ct,u[0]||(u[0]=[e("p",{class:"text-2xl text-gray-500"},"Belum melakukan pendaftaran",-1)])))])),e("span",At,[s(p,{name:"document-check",size:"32",class:"h-6 w-6"})])])])}}}),Vt={class:"flex flex-col space-y-4 md:flex-row md:space-x-4 md:space-y-0"},Mt={class:"flex-1"},It={class:"flex-1"},Ot=k({__name:"DashboardSiswa",setup(f){const t=W();return(o,i)=>{var h,u,d;return a(),r("div",Vt,[e("div",Mt,[s($t,{photo_url:n(t).user.student.thumbnail_url,nameText:(h=n(t).user)==null?void 0:h.student.nama,username:(u=n(t).user)==null?void 0:u.username,tanggal_lahir:(d=n(t).user)==null?void 0:d.student.tanggal_lahir,role:n(t).role,class:"h-full"},null,8,["photo_url","nameText","username","tanggal_lahir","role"])]),e("div",It,[s(Bt,{class:"h-full"})])])}}}),aa=k({__name:"DashboardView",setup(f){const t=A(null),i=W().role,h={DashboardAdmin:z(De),DashboardSekolah:z(ht),DashboardSiswa:z(Ot)};switch(i){case"siswa":t.value=h.DashboardSiswa;break;case"sekolah":t.value=h.DashboardSekolah;break;case"super_admin":t.value=h.DashboardAdmin;break}return(u,d)=>(a(),w(re,null,{default:y(()=>[(a(),w(le(t.value)))]),_:1}))}});export{aa as default};
