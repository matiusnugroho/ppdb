import{a9 as E,h as o,M as d,U as S,L as i}from"../index.js";import{u as g}from"./formValidationErrors.YeWR-HPr.js";const _=E("pagination",()=>{const h=o(20),f=o(1),l=o(1),e=o(null),n=o(null),k=o("");return{per_page:h,page:l,jenjang:e,kecamatan_id:n,search:k,currentPage:f,resetTodefault:()=>{h.value=20,f.value=1,l.value=1,e.value=null,n.value=null,k.value=""}}},{persist:!0});function P(){const h=o(null),f=o([]),l=o(null),e=o(!1),n=_();return{dataSekolah:h,error:l,loadingSekolah:e,sekolahList:f,fetchAllSekolah:async(r=20,s=1,a="",t="",u="")=>{let c=`${i.GET_SEKOLAH_ALL}?per_page=${r}&page=${s}`;a&&a!="null"&&(c+=`&jenjang=${a}`),t&&t!="null"&&(c+=`&kecamatan_id=${t}`),u&&(c+=`&search=${u}`),n.per_page=r,n.page=s,n.currentPage=s,n.jenjang=a,n.kecamatan_id=t,e.value=!0;try{const p=await d.get(c);h.value=p.data}catch{l.value="Failed to load sekolah list"}finally{e.value=!1}},fetchSekolah:async(r,s="")=>{const a=S(i.GET_SEKOLAH,{kecamatan_id:r,jenjang:s});e.value=!0;try{const t=await d.get(a);f.value=t.data.data}catch{l.value="Failed to load sekolah list"}finally{e.value=!1}},fetchSekolahById:async r=>{const s=S(i.GET_SEKOLAH_BY_ID,{id:r});e.value=!0;try{return(await d.get(s)).data.data}catch{return l.value="Failed to load sekolah data",null}finally{e.value=!1}},updateSekolah:async(r,s)=>{const a=S(i.UPDATE_SEKOLAH,{id:r});e.value=!0;try{return(await d.put(a,s)).data.success}catch{return l.value="Failed to update sekolah",!1}finally{e.value=!1}},createSekolah:async r=>{var t,u,c,p;const s=i.REGISTER_SEKOLAH,a=g();e.value=!0,l.value=null;try{return{success:!0,data:(await d.post(s,r)).data}}catch(v){return l.value=((u=(t=v.response)==null?void 0:t.data)==null?void 0:u.message)||"Failed to create sekolah",(p=(c=v.response)==null?void 0:c.data)!=null&&p.errors&&(a.errors=v.response.data.errors),{success:!1,error:l.value}}finally{e.value=!1}},deleteSekolah:async r=>{var a,t;const s=S(i.UPDATE_SEKOLAH,{id:r});e.value=!0;try{return{success:!0,data:(await d.delete(s)).data}}catch(u){return l.value=((t=(a=u.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to delete sekolah",{success:!1,error:l.value}}finally{e.value=!1}}}}export{P as a,_ as u};
