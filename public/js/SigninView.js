import{f as V,o as m,c as k,a as o,e as g,t as C,i as h,n as x,y as w,E as A,g as d,u as B,z as F,j as N,k as S,w as c,d as n,p as f,q as L,A as P,r as T}from"../index.js";import{_ as I,a as M,P as U}from"./PlainLayout.js";import{_ as q}from"./_plugin-vue_export-helper.js";import{I as D,A as G}from"./AlertSuccess.js";import{u as j}from"./authComposable.js";import{s as z}from"./toast.js";import{_ as K}from"./SpinnerLoading.vue_vue_type_script_setup_true_lang.js";import"./login-ilustrasi.js";import"./HeroIcon.vue_vue_type_script_setup_true_lang.js";const O=V({props:{label:String,type:String,placeholder:String,customClasses:String,name:String,required:{type:Boolean,default:!1},modelValue:String},emits:["update:modelValue"],methods:{updateValue(e){this.$emit("update:modelValue",e.value)}}}),W={class:"mb-2.5 block text-black dark:text-white"},H={key:0,class:"text-meta-1"},J=["type","placeholder","value","name","autocomplete"];function Q(e,s,p,i,l,u){return m(),k("div",{class:x(e.customClasses)},[o("label",W,[g(C(e.label)+" ",1),e.required?(m(),k("span",H,"*")):h("",!0)]),o("input",{type:e.type,placeholder:e.placeholder,value:e.modelValue,name:e.name,autocomplete:e.name,onInput:s[0]||(s[0]=b=>e.updateValue(b.target)),class:"w-full rounded border-[1.5px] text-black border-stroke bg-transparent py-2 px-2 font-normal outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:text-white dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"},null,40,J)],2)}const X=q(O,[["render",Q]]),Y=async()=>{var e;try{await w.get(A.CSRF,{withCredentials:!0})}catch(s){throw w.isAxiosError(s)?new Error(((e=s.response)==null?void 0:e.data.message)||"Failed to get CSRF token"):new Error("An unexpected error occurred")}},Z={class:"mb-5 mt-6"},ee=["disabled"],ae={class:"flex items-center"},te={class:"mt-6 text-center"},se={class:"font-medium"},ce=V({__name:"SigninView",setup(e){const s=d(""),p=d(""),i=d(!1),l=d(!1),u=d(""),{login:b}=j(),$=P(),E=B(),y=F(),R=async()=>{try{await Y()}catch(r){console.error(r),z({message:"Gagal mengambil CSRF token, silakan muat ulang halaman login ini",type:"warning",duration:5e3,autoClose:!0})}},_=async()=>{var r,a;i.value=!0,l.value=!1;try{await b(s.value,p.value)}catch(t){((r=t==null?void 0:t.response)==null?void 0:r.status)===401||((a=t==null?void 0:t.response)==null?void 0:a.status)===422?(l.value=!0,u.value="Username atau password salah"):(t==null?void 0:t.code)==="ERR_NETWORK"?(l.value=!0,u.value="Koneksi internet bermasalah"):(l.value=!0,u.value="Sepertinya jaringan anda atau server kami mengalami masalah, coba lagi beberapa saat")}finally{i.value=!1}};return N(async()=>{const r=$.query.intended||"/dashboard";E.intendedURL=r,await R()}),(r,a)=>{const t=T("router-link");return m(),S(U,null,{default:c(()=>[n(M,{subtitle:"PPDB Online Kuantan Singingi v1",title:"Login"},{default:c(()=>[l.value?(m(),k("div",{key:0,class:x(["mb-2 mt-4 transform transition-all duration-500 ease-out",{"opacity-0 translate-y-5":!l.value,"opacity-100 translate-y-0":l.value}])},[n(f(D),{icon:"",type:"danger"},{default:c(()=>[g(C(u.value),1)]),_:1})],2)):h("",!0),f(y).messages.success?(m(),S(G,{key:1,class:"mb-5",message:f(y).messages.success.title,detail:f(y).messages.success.detail},null,8,["message","detail"])):h("",!0),o("form",{onSubmit:L(_,["prevent"])},[n(X,{name:"username",label:"Email / Username",type:"email",placeholder:"Enter your email",modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=v=>s.value=v)},null,8,["modelValue"]),n(I,{label:"Password anda",modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=v=>p.value=v)},null,8,["modelValue"]),o("div",Z,[o("button",{type:"submit",class:"w-full flex justify-center items-center cursor-pointer rounded-lg border border-primary bg-primary p-2 font-medium text-white transition hover:bg-opacity-90",onClick:_,disabled:i.value},[o("span",ae,[n(K,{loading:i.value,size:"xs"},null,8,["loading"]),a[2]||(a[2]=o("span",{class:"ml-2"},"Login",-1))])],8,ee)]),o("div",te,[o("p",se,[a[4]||(a[4]=g(" Belum Mempunyai Akun? ")),n(t,{to:"/daftar",class:"text-primary"},{default:c(()=>a[3]||(a[3]=[g("Daftar")])),_:1})])])],32)]),_:1})]),_:1})}}});export{ce as default};
