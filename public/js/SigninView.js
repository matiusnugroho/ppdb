import{f as S,o as i,c as b,a,e as g,t as h,i as _,n as x,C,E as R,g as m,u as A,j as D,r as P,k,w as f,b as d,p,q as F,A as N}from"../index.js";import{u as q,_ as M,a as T,P as j}from"./messages.js";import{_ as V}from"./_plugin-vue_export-helper.js";import{a as U,_ as G}from"./authComposable.js";import{P as I,b as K}from"./flowbite-vue.js";import{s as O}from"./toast.js";import"./login-ilustrasi.js";import"./HeroIcon.vue_vue_type_script_setup_true_lang.js";const z=S({props:{label:String,type:String,placeholder:String,customClasses:String,required:{type:Boolean,default:!1},autocomplete:{type:String,default:""},modelValue:String},emits:["update:modelValue"],methods:{updateValue(e){this.$emit("update:modelValue",e.value)}}}),W={class:"mb-2.5 block text-black dark:text-white"},Z={key:0,class:"text-meta-1"},H=["type","placeholder","value","autocomplete"];function J(e,s,c,o,l,u){return i(),b("div",{class:x(e.customClasses)},[a("label",W,[g(h(e.label)+" ",1),e.required?(i(),b("span",Z,"*")):_("",!0)]),a("input",{type:e.type,placeholder:e.placeholder,value:e.modelValue,autocomplete:e.autocomplete,onInput:s[0]||(s[0]=y=>e.updateValue(y.target)),class:"w-full rounded border-[1.5px] text-black border-stroke bg-transparent py-2 px-2 font-normal outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:text-white dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"},null,40,H)],2)}const Q=V(z,[["render",J]]),X=async()=>{var e;try{await C.get(R.CSRF,{withCredentials:!0})}catch(s){throw C.isAxiosError(s)?new Error(((e=s.response)==null?void 0:e.data.message)||"Failed to get CSRF token"):new Error("An unexpected error occurred")}},Y=S({name:"AlertSuccess",props:{message:{type:String,required:!0},detail:{type:String,required:!1}}}),ee={class:"flex w-full border-l-6 border-[#34D399] bg-[#34D399] bg-opacity-[15%] px-4 py-5 shadow-md dark:bg-[#1B1B24] dark:bg-opacity-30 md:p-6"},ae=a("div",{class:"mr-5 flex h-9 w-full max-w-[36px] items-center justify-center rounded-lg bg-[#34D399]"},[a("svg",{width:"16",height:"12",viewBox:"0 0 16 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M15.2984 0.826822L15.2868 0.811827L15.2741 0.797751C14.9173 0.401867 14.3238 0.400754 13.9657 0.794406L5.91888 9.45376L2.05667 5.2868C1.69856 4.89287 1.10487 4.89389 0.747996 5.28987C0.417335 5.65675 0.417335 6.22337 0.747996 6.59026L0.747959 6.59029L0.752701 6.59541L4.86742 11.0348C5.14445 11.3405 5.52858 11.5 5.89581 11.5C6.29242 11.5 6.65178 11.3355 6.92401 11.035L15.2162 2.11161C15.5833 1.74452 15.576 1.18615 15.2984 0.826822Z",fill:"white",stroke:"white"})])],-1),te={class:"w-full"},se={class:"mb-3 text-lg font-bold text-black dark:text-[#34D399]"},oe={key:0,class:"text-base leading-relaxed text-body"};function le(e,s,c,o,l,u){return i(),b("div",ee,[ae,a("div",te,[a("h5",se,h(e.message),1),e.detail?(i(),b("p",oe,h(e.detail),1)):_("",!0)])])}const re=V(Y,[["render",le]]),ne={class:"flex justify-center"},ie={class:"mb-5 mt-6"},ue=["disabled"],de={class:"flex items-center"},ce=a("span",{class:"ml-2"},"Login",-1),me={class:"mt-6 text-center"},pe={class:"font-medium"},ke=S({__name:"SigninView",setup(e){const s=m(""),c=m(""),o=m(!1),l=m(!1),u=m(""),{login:y}=U(),L=N(),B=A(),v=q(),E=async()=>{try{await X()}catch(r){console.error(r),O({message:"Gagal mengambil CSRF token, silakan muat ulang halaman login ini",type:"warning",duration:5e3,autoClose:!0})}},$=async()=>{var r,n;o.value=!0,l.value=!1;try{await y(s.value,c.value)}catch(t){((r=t==null?void 0:t.response)==null?void 0:r.status)===401||((n=t==null?void 0:t.response)==null?void 0:n.status)===422?(l.value=!0,u.value="Username atau password salah"):(t==null?void 0:t.code)==="ERR_NETWORK"?(l.value=!0,u.value="Koneksi internet bermasalah"):(l.value=!0,u.value="Sepertinya jaringan anda atau server kami mengalami masalah, coba lagi beberapa saat")}finally{o.value=!1}};return D(async()=>{const r=L.query.intended||"/dashboard";B.intendedURL=r,await E()}),(r,n)=>{const t=P("router-link");return i(),k(j,null,{default:f(()=>[a("div",ne,[d(G)]),d(T,{subtitle:"PPDB Online Kuantan Singingi v1",title:"Login"},{default:f(()=>[a("div",{class:x(["mb-5 mt-6 transform transition-all duration-500 ease-out",{"opacity-0 translate-y-5":!l.value,"opacity-100 translate-y-0":l.value}])},[d(p(I),{icon:"",type:"danger"},{default:f(()=>[g(h(u.value),1)]),_:1})],2),p(v).messages.success?(i(),k(re,{key:0,class:"mb-5",message:p(v).messages.success.title,detail:p(v).messages.success.detail},null,8,["message","detail"])):_("",!0),a("form",{onSubmit:F($,["prevent"])},[d(Q,{label:"Email / Username",type:"email",placeholder:"Enter your email",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=w=>s.value=w)},null,8,["modelValue"]),d(M,{label:"Password anda",modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=w=>c.value=w)},null,8,["modelValue"]),a("div",ie,[a("button",{type:"submit",class:"w-full flex justify-center items-center cursor-pointer rounded-lg border border-primary bg-primary p-2 font-medium text-white transition hover:bg-opacity-90",onClick:$,disabled:o.value},[a("span",de,[o.value?(i(),k(p(K),{key:0,size:"4",color:"white",class:x(["transition-all duration-500 ease-out",{"opacity-0 -translate-x-5":!o.value,"opacity-100 translate-x-0":o.value}])},null,8,["class"])):_("",!0),ce])],8,ue)]),a("div",me,[a("p",pe,[g(" Belum Mempunyai Akun? "),d(t,{to:"/daftar",class:"text-primary"},{default:f(()=>[g("Daftar")]),_:1})])])],32)]),_:1})]),_:1})}}});export{ke as default};
